.\" Text automatically generated by txt2man
.TH oo-gear-firewall 8 "10 October 2014" "" ""
.SH NAME
\fBoo-gear-firewall
\fB
.SH SYNOPSIS
.nf
.fam C
\fBoo-gear-firewall\fP [\fIOPTIONS\fP]

.fam T
.fi
.fam T
.fi
.SH DESCRIPTION
Create firewall rules and SELinux policy to contain gears to their
own internal IPs. Gears are identified as a range of user IDs on the
system. Static sets of rules and policy are created once to isolate
all possible gears in the range.
.PP
The UID range should be the same across all hosts in a gear profile. By
default the range is taken from district settings if known, or 1000-6999
if not. The tool may be re-run to apply rules and policy for a changed
UID range.
.PP
Firewall rules are implemented via iptables and prevent gears
from connecting to IPs that belong to other gears.
.PP
SELinux policies are implemented via semanage and prevent gears
from binding (listening) on IPs that belong to other gears.
.SH OPTIONS
.TP
.B
\fB-i\fP|\fB--iptables\fP MODE
Mode in which to operate on iptables firewall rules. One of:
.RS
.IP \(bu 3
output: only displays the rules that would be created.
.IP \(bu 3
enable: saves, modifies, and reloads the live rules.
.IP \(bu 3
dryrun: saves live rules, copies and modifies them in a separate file only.
.IP \(bu 3
conf: edits existing rules in /etc/sysconfig/iptables without save or reload.
.IP \(bu 3
disable: disables relevant rules.
.RE
.TP
.B
\fB-s\fP|\fB--selinux\fP MODE
Mode in which to operate on SELinux policy. One of:
.RS
.IP \(bu 3
output: only displays the policy that would be created.
.IP \(bu 3
enable: modifies SELinux policy.
.IP \(bu 3
disable: disables relevant SELinux policy.
.RE
.TP
.B
\fB-b\fP|\fB--begin_uid\fP UID
First UID (defaults to district setting)
.TP
.B
\fB-e\fP|\fB--end_uid\fP UID
Last UID (defaults to district setting)
.TP
.B
\fB-h\fP|\fB--help\fP
Print usage notice.
.SH CONFIGURATION
.TP
.B
/var/lib/openshift/.settings/district.info
Once districted, a node has the district UID range in this file.
.SH EXAMPLE
.TP
.B
$ \fBoo-gear-firewall\fP \fB-i\fP enable \fB-s\fP enable
Enable rules and policy on a live node host
.TP
.B
$ \fBoo-gear-firewall\fP \fB-i\fP conf \fB-s\fP enable \fB-b\fP 1000 \fB-e\fP 2999
Enable during an install before iptables is started or node districted
.TP
.B
$ \fBoo-gear-firewall\fP \fB-i\fP disable \fB-s\fP disable
Disable rules and policy on a live node host
.SH CAVEATS
Live changes of the iptables rules save the current rules, modify the
saved file, and reload the rules. The tool does not attempt to prevent
modifications during this process, so administrators should refrain from
modifying live or written rules in /etc/sysconfig/iptables concurrently
with this tool. DNAT rules managed by openshift-iptables-port-proxy
are reloaded after live changes are made, so they should not be lost.
.PP
The iptables firewall rules are implemented via a hardcoded filter
named rhc-app-contain; it is assumed that this tool is the sole manager
of this filter. They refer also to the rhc-app-comm filter which is
managed by the openshift-iptables-port-proxy service. Violations of
these assumptions are unsupported.
.PP
Before modifying /etc/sysconfig/iptables a timestamped copy is saved.
.SH AUTHOR
Luke Meyer <lmeyer@redhat.com> - man page written for OpenShift Origin 
